---
sidebar_label: Unit Test
sidebar_position: 3
---

# Unit Tests

Unit tests for LLMs are assertions and checks designed to quickly identify obvious bugs and regressions in your AI system. These tests are typically small, fast, and cheap to run. They verify that individual components of your system work as expected.

## Writing Tests

To sync unit tests with LangSmith, decorate your `pytest` test functions with `@unit`. For example:

```python
from langsmith import unit, traceable

@traceable
def generate_sql(user_query):
    # Replace with your SQL generation logic
    return "SELECT * FROM customers"

@unit
def test_sql_generation_select_all():
    user_query = "Get all users from the customers table"
    sql = generate_sql(user_query)
    assert sql == "SELECT * FROM customers"
```

Any time you run this test suite (e.g., using `pytest`), LangSmith will track it as a new `experiment` and log the test result as `pass` feedback (1 for pass, 0 for fail).
Each test case is synced as an `example` to a corresponding dataset in LangSmith.

`@unit` works well with `pytest` fixtures. The input For example:

```python
import pytest

@pytest.fixture
def user_query():
    return "Get all users from the customers table"

@pytest.fixture
def expected_sql():
    return "SELECT * FROM customers"

# output_keys indicate which test arguments to save as 'outputs' in the dataset (Optional)
@unit(output_keys=["expected_sql"])
def test_sql_generation_with_fixture(user_query, expected_sql):
    sql = generate_sql(user_query)
    assert sql == expected_sql
```

Use `pytest`'s parametrize functionality to run the same assertions across multiple data points. For example:

```python
@unit
@pytest.mark.parametrize(
    "user_query, expected_sql",
    [
        ("Get all users from the customers table", "SELECT * FROM customers"),
        ("Get all users from the orders table", "SELECT * FROM orders"),
    ],
)
def test_sql_generation_parametrized(user_query, expected_sql):
    sql = generate_sql(user_query)
    assert sql == expected_sql
```

## Running Tests

To run your tests, use the `pytest` command in your terminal. For example:

```bash
pytest tests/
```

All decorated test functions will be executed and logged to LangSmith under a dataset named after your package or github repository and a new `TestSuite` experiment.

![Unit Test Example](/img/unit-test-suite.png)

## Conclusion

Unit testing is a fast way to catch simple bugs and regressions in your AI system, especially when you want to add specific checks on a small number of test cases. They are an easy starting point to use when you are just starting out if you don't have time to commit to more comprehensive evaluation approaches.


:::note
`@unit` is currently only supported in python version `>=0.1.42`. If you are interested in unit testing functionality in TypeScript or other languages, please let us know at [support@langchain.dev](mailto:support@langchain.dev).
:::